<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code & Grow</title>
    <link rel="stylesheet" href="/stylesheets/body.css" />
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>

  <body>
    <div class="start-screen settings-page">
      <div class="content-container">
        <div class="page-header-row">
          <a href="/main-pages/start-menu.html" class="back-button">
            <i class="fa-solid fa-house"></i>
          </a>

          <h1 class="page-title">Settings</h1>
        </div>

        <div class="blackboard">
          <div class="setting-row">
            <span class="setting-label">Background Music</span>
            <label class="toggle-switch">
              <input type="checkbox" id="bgmToggle" checked />
              <span class="slider"></span>
            </label>
          </div>

          <div class="setting-row">
            <span class="setting-label">Sound Effects</span>
            <label class="toggle-switch">
              <input type="checkbox" id="sfxToggle" checked />
              <span class="slider"></span>
            </label>
          </div>

          <div class="setting-row">
            <span class="setting-label">Volume</span>
            <div class="volume-slider">
              <input type="range" id="volumeSlider" min="0" max="100" value="60" />
              <span class="volume-display" id="volumeDisplay">60%</span>
            </div>
          </div>

          <div class="setting-row">
            <span class="setting-label">Hints</span>
            <label class="toggle-switch">
              <input type="checkbox" id="hintsToggle" />
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <audio id="bgmAudio" src="/assets/music/menu.mp3" preload="auto" loop></audio>
    <audio id="clickSound" src="/assets/music/button.mp3" preload="auto"></audio>

    <script src="/scripts/sound-manager.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const settings = getAudioSettings();
        document.getElementById('bgmToggle').checked = settings.bgmEnabled;
        document.getElementById('sfxToggle').checked = settings.sfxEnabled;

        const volumePercent = Math.round(settings.volume * 100);
        document.getElementById('volumeSlider').value = volumePercent;
        document.getElementById('volumeDisplay').textContent = volumePercent + '%';

        const hintsEnabled = localStorage.getItem('hintsEnabled') === 'true';
        document.getElementById('hintsToggle').checked = hintsEnabled;
      });

      document.getElementById('bgmToggle').addEventListener('change', function() {
        setBgmEnabled(this.checked);
      });
      document.getElementById('sfxToggle').addEventListener('change', function() {
        setSfxEnabled(this.checked);
        if (this.checked) {
          playSound('click');
        }
      });

      document.getElementById('volumeSlider').addEventListener('input', function() {
        const volume = this.value / 100;
        document.getElementById('volumeDisplay').textContent = this.value + '%';
        setVolume(volume);
      });
      
      document.getElementById('hintsToggle').addEventListener('change', function() {
        localStorage.setItem('hintsEnabled', this.checked);
      });
    </script>
  </body>
</html>